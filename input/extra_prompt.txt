Use schemas to replace all of the repeated code.